<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Tchat SELEZIONE BASIQUE</title>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <style>
    body { background: #181818; color: #fff; margin:0; }
    .center {
      max-width: 500px;
      margin: 40px auto;
      padding: 28px;
      background: #232323;
      border-radius: 16px;
      box-shadow: 0 2px 14px #0006;
    }
    h2 { margin-bottom: 16px; }
    input, button {
      padding: 8px;
      margin: 4px;
      border-radius: 5px;
      border: none;
    }
    input { width: 45%; }
    button {
      background: #FFC300;
      color: #222;
      font-weight: bold;
      cursor: pointer;
      margin-left: 8px;
    }
    .msg { margin-top: 18px; }
    .item { padding: 6px 0; border-bottom: 1px solid #222; }
    .item strong { color: #FFC300; }
  </style>
</head>
<body>
  <div class="center">
    <h2>Tchat SELEZIONE BASIQUE</h2>
    <input id="pseudo" placeholder="Pseudo">
    <input id="message" placeholder="Message">
    <button id="envoyer">Envoyer</button>
    <div class="msg" id="messages"></div>
  </div>
  <script>
    // 1. Renseigne tes clés Supabase ici :
    const SUPABASE_URL = 'https://xxxxxxxxxxxxxxxxxxxx.supabase.co';
    const SUPABASE_KEY = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx';

    const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    const pseudoInput = document.getElementById('pseudo');
    const messageInput = document.getElementById('message');
    const envoyerBtn = document.getElementById('envoyer');
    const messagesDiv = document.getElementById('messages');

    async function loadMessages() {
      const { data, error } = await supabase
        .from('message')
        .select('*')
        .order('created_at', { ascending: false })
        .limit(20);
      messagesDiv.innerHTML = '';
      if (data) {
        data.reverse().forEach(msg => {
          messagesDiv.innerHTML += `<div class="item"><strong>${msg.pseudo}</strong> : ${msg.content}</div>`;
        });
      }
    }

    envoyerBtn.onclick = async () => {
      const pseudo = pseudoInput.value.trim();
      const message = messageInput.value.trim();
      if (!pseudo || !message) return alert("Pseudo & message obligatoires !");
      await supabase.from('message').insert([{ pseudo, content: message }]);
      messageInput.value = '';
      await loadMessages();
    };

    // Rafraîchir à l'ouverture
    loadMessages();

    // Auto-refresh toutes les 5s (optionnel, tu peux enlever)
    setInterval(loadMessages, 5000);
  </script>
</body>
</html>
